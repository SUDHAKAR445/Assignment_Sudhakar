package dataStructure;

import dataStructure.LinkedListImplementation.Node;

public class CircularLinkedListImplementaion 
{
	static class Node 
	{
	    int data;
	    Node next;
	    Node() {}
	    Node(int data) 
	    {
	      this.data = data;
	    }
	  }

	  private Node head;
	  private Node tail;
   
	  public CircularLinkedListImplementaion()
	  {
		  this.head = null;
	      this.tail = null;
	  }

	  public boolean isEmpty() 
	  {
		  return head == null;
	  }
	  public void insert(int data)
	  {
		  Node newNode = new Node(data);
		  if(head == null)
		  {
			  head = newNode;
			  tail = newNode;
		  }
		  else
		  {
			  tail.next = newNode;
			  tail = newNode;
		  }
		  
	  }
	  public void insertBegin(int data) 
	  {
	    Node newNode = new Node(data);  
	    if (head == null) 
	    {  
	    	head = newNode;
	        tail = newNode;
	        newNode.next = head;
	    } 
	    else 
	    {
	    	Node temp = head;
	        newNode.next = temp;   
	        head = newNode;   
	        tail.next = head;
	    }
	  }
	  public void insertEnd(int data) 
	  { 
	    Node newNode = new Node(data);   
	    if (head == null) 
	    {  
	        head = newNode;
	        tail = newNode;
	        newNode.next = head;
	    } 
	    else 
	    {  
	    	tail.next = newNode;  
	        tail = newNode;   
	        tail.next = head;
	    }
	  }

	  public void insertAtIndex(int data, int position) 
	  {
		  Node temp, newNode;
		  int i, count;
		  newNode = new Node();
		  temp = head;
		  count = size();
		  if (temp == null || size() < position)
		  {
			  System.out.println("Index is greater than size of the list");
		  }
		  else 
		  {
			  newNode.data = data;
			  for (i = 1; i < position - 1; i++) 
			  {
				  temp = temp.next;
			  }
			  newNode.next = temp.next;
			  temp.next = newNode;
		  }
	  }

	  public void deleteFirst() 
	  {
	    if (head == null) 
	    {
	      return;
	    } 
	    else 
	    {
	      if (head != tail) 
	      {
	        head = head.next;
	        tail.next = head;
	      }   
	      else 
	      {
	        head = tail = null;
	      }
	    }
	  }

	  public void deleteAtPosition(int position)
	  {
		  Node temp = head;
		  Node prev = head;
		  for(int i =0; i<position; i++)
		  {
			  if(i == 0 && position == 1)
			  {
				  head = head.next;
			  }
			  else
			  {
				  if(i == position -1 && temp != null)
				  {
					  prev.next = temp.next;
				  }
				  else
				  {
					  prev = temp;
					  if(prev == null)
					  {
						  break;
					  }
					  temp = temp.next;
					  tail = temp;
					  tail.next = head;
				  }
			  }
		  }
	  }
	  public void deleteLast() 
	  {
	    if (head == null) 
	    {
	    	return;
	    } 
	    else
	    {
	    	if (head != tail) 
	    	{
	    		Node current = head;
	    		while (current.next != tail) 
	    		{
	    			current = current.next;
	    		} 
	    		tail = current;   
	    		tail.next = head;
	    	}  
	    	else 
	    	{
	    		head = tail = null;
	    	}
	    }
	  }

	  public void deleteNode(int data) 
	  {
	    if (head == null)
	    {	
	    	System.out.println("List is empty");
	    }
	    Node curr = head;
	    Node prev = new Node();
	    while (curr.data != data) 
	    {
	    	if (curr.next == head)
	    	{
	    		System.out.println("Given node with data " + data + " is not found in the circular linked list.");
	    		break;
	    	}
	    	prev = curr;
	    	curr = curr.next;
	    } 
	    if (curr == head && curr.next == head) 
	    {
	    	head = null;
	    } 
	    if (curr == head) 
	    {
	    	prev = head;
	    	while (prev.next != head) 
	    	{
	    		prev = prev.next;
	    	}
	    	head = curr.next;
	    	prev.next = head;
	    }
	    else if (curr.next == head) 
	    {
	    	prev.next = head;
	    }
	    else 
	    {
	    	prev.next = curr.next;
	    }
	  }
	  
	  public void display() 
	  {
		  Node temp = head;
		  if (head != null) 
		  {
			  do {
				  	System.out.printf("%d ", temp.data);
				  	temp = temp.next;
			  	 } while (temp != head);
		  }
		  System.out.printf("\n");
	  }

	  public int size() 
	  {
		  int size = 0;
		  if (head != null) 
		  {
			  Node temp = head;
			  while (temp.next != head) 
			  {
				  temp = temp.next;
				  size++;
			  }
			  size++;
		  }
		  return size;
	  }

	  public void searchNode(int data) 
	  {
		  System.out.println("Searching for data:" + data);   
		  Node current = head;
		  int i = 1;
		  boolean flag = false; 
		  if (head == null) 
		  {
			  System.out.println("List is empty");
		  } 
		  else 
		  {
			  do {  
				  	if (current.data == data) 
				  	{
				  		flag = true;
				  		break;
				  	}
				  	current = current.next;
				  	i++;
			   	 } while (current != head);
			  if (flag)
				  System.out.println("Element is present in the list at the position : " + i);
			  else
				  System.out.println("Element is not present in the list");
		  }
	  }

}
